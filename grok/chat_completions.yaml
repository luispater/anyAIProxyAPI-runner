version: "1"
name: "chat_completions"
need_report_token: false
workflow:
  ####################### Start Click the new chat button #######################
  - index: 100
    action: "Click"
    params:
      - 'a[type="button"][href="/"]'
      - "2500"
    result:
      - result_index: 0
        type: "error"
        policy:
          has_error: "CONTINUE"
          no_error: "CONTINUE"
  ####################### End Click the new chat button #######################

  ####################### Start Input User Prompt #######################
  - index: 200
    action: "BuildPrompt"
    description: "Check if the request has a User Prompt"
    params:
      - "#REQUEST#"
      - "true"
    result:
      - result_index: 0
        name: "UserPrompt"
        type: "string"
      - result_index: 1
        type: "error"
        policy:
          no_error: "DO-WORKFLOW"
          has_error: "FAILED"
    workflow:
      - index: 0
        action: "Input"
        description: "Input the User Prompt to the input box"
        params:
          - 'textarea[dir="auto"]'
          - "#UserPrompt#"
          - "5000"
        result:
          - result_index: 0
            type: "error"
            policy:
              no_error: "CONTINUE"
              has_error: "FAILED"
  ####################### End Input User Prompt #######################

#  ####################### Start StartSniffing #######################
#  - index: 300
#    action: "StartSniffing"
#    description: "Start sniff"
#    params: [ '#PROXY#' ]
#  ####################### End StartSniffing #######################
#
#  ####################### Start Sleep 1 second #######################
#  - index: 400
#    action: "SleepMilliseconds"
#    description: "Sleep 200 millisecond"
#    params:
#      - "200"
#    result:
#      - result_index: 0
#        type: "bool"
#        policy:
#          is_true: "CONTINUE"
#  ####################### End Sleep 1 second #######################
#
#  ####################### Start Click Run Button #######################
#  - index: 500
#    action: "Click"
#    description: "Click the run button"
#    params: ['button[type="submit"]', '2500']
#    result:
#      - result_index: 0 # like this, didn't store the result
#        type: "error"
#        policy:
#          has_error: "FAILED"
#  ####################### End Click Run Button #######################
#
#  ####################### Start Click Run Button #######################
#  - index: 600
#    action: "GetDataFromProxy"
#    description: "Get data from proxy"
#    params:
#      - "#PROXY#"
#      - "#PROXY-DATA-CHANNEL#"
#    retry: 65536
#    result:
#      - result_index: 0
#        type: "bool"
#        policy:
#          is_true: "CONTINUE"
#      - result_index: 1
#        type: "error"
#        policy:
#          has_error: "LOOP"
#  ####################### End Click Run Button #######################
#
#  ####################### Start StartSniffing #######################
#  - index: 700
#    action: "StopSniffing"
#    description: "Stop sniff"
#    params: [ '#PROXY#' ]
#  ####################### End StartSniffing #######################
